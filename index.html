<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="application-name" content="TiddlyWiki Plugin Library" />
<meta name="application-version" content="v5.1.14" />
<meta name="copyright" content="Copyright 2017 Andrew Harrison" />
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<title>TiddlyWiki Library for Plugins by Andrew Harrison</title>
<script>
var assetList = [
    {
        "title": "$:/plugins/ajh/copy",
        "description": "Copy Button",
        "author": "Andrew",
        "core-version": ">=5.0.0",
        "list": "readme",
        "version": "0.0.22",
        "plugin-type": "plugin",
        "dependents": "",
        "type": "application/json",
	"readme": "This plugin button can copy the transcluded contents of a tiddler to the Clipboard. It can be called by transcluding a tiddler and using the `$:/copy` template. Example usage: `{{Tiddler title to transclude||$:/copy}}`.\n\nSimply drag $:/plugins/ajh/copy to the top of your tiddlywiki display, save and reload.\n\nThis plugin comprises:\n\n* JavaScript code module\n* Icon\n* Template\n* Stylesheet\n* Caption, hint, and notification\n"
    },
    {
        "title": "$:/plugins/ajh/favorites",
        "description": "Favorites",
        "author": "Andrew",
	"core-version": ">=5.1.14",
        "list": "readme",
	"version": "3.0.3",
	"source": "https://github.com/infurnoape/tw5-plugins",
        "plugin-type": "plugin",
	"dependents": "",
        "type": "application/json",
	"readme": "This plugin adds the <span class='tc-btn-dropdown'>{{$:/core/images/star-filled}}</span> favorites button to the View Toolbar and also the <span class='tc-btn-dropdown'>{{$:/core/images/star-filled}}</span> tab to the Sidebar. The favorites button turns yellow <span class='tc-btn-dropdown'>{{$:/plugins/ajh/favorites/image}}</span> when selected and then the tiddler appears in the list on the <span class='tc-btn-dropdown'>{{$:/core/images/star-filled}}</span> tab. The list can be sorted using drag and drop. To drag an item, select it, then hold down the mouse or trackpad button while you drag it to a new location in the list. Release the button to drop the item into place. Unneeded favorites can be removed from the list by using the <span class='tc-btn-dropdown'>{{$:/plugins/ajh/favorites/image}}</span> favorites button in the tiddler.\n\nSimply drag $:/plugins/ajh/favorites to the top of your tiddlywiki display, save and reload.\n\nThis plugin comprises:\n\n* Template\n* Sidebar tab"
    },
    {
        "title": "$:/plugins/ajh/locations",
        "description": "Locations Button",
        "author": "Andrew",
        "version": "0.0.2",
        "core-version": ">=5.1.11",
        "source": "https://github.com/infurnoape/tw5-plugins",
        "plugin-type": "plugin",
	"list": "readme",
        "dependents": "",
        "type": "application/json"
    },
    {
        "title": "$:/plugins/ajh/openall",
        "description": "Open All Button",
        "author": "Andrew",
        "version": "0.0.1",
        "core-version": ">=5.1.11",
        "source": "https://github.com/infurnoape/tw5-plugins",
        "plugin-type": "plugin",
	"list": "readme",
        "dependents": "",
        "type": "application/json"
    },
    {
        "title": "$:/plugins/ajh/randombackground",
        "description": "Random Background",
        "author": "Andrew",
        "version": "0.1.1",
        "core-version": ">=5.1.11",
        "source": "https://github.com/infurnoape/tw5-plugins",
        "plugin-type": "plugin",
	"list": "readme",
        "dependents": "",
        "type": "application/json"
    },
    {
        "title": "$:/plugins/ajh/reduce",
        "description": "Reduce Button",
        "author": "Andrew",
        "version": "0.0.1",
        "core-version": ">=5.1.12",
        "source": "https://github.com/infurnoape/tw5-plugins",
        "plugin-type": "plugin",
	"list": "readme",
        "dependents": "",
        "type": "application/json"
    },
    {
        "title": "$:/plugins/ajh/showfields",
        "description": "Show Fields",
        "author": "Andrew",
        "version": "0.0.1",
        "core-version": ">=5.1.14",
        "source": "https://github.com/infurnoape/tw5-plugins",
        "plugin-type": "plugin",
	"list": "readme",
        "dependents": "",
        "type": "application/json"
    },
    {
        "title": "$:/plugins/ajh/tiddlycopy",
        "description": "Tiddly Link Copy Button",
        "author": "Andrew",
        "version": "0.0.30",
        "core-version": ">=5.1.11",
        "source": "https://github.com/infurnoape/tw5-plugins",
        "plugin-type": "plugin",
	"list": "readme",
        "dependents": "",
        "type": "application/json"
    },
    {
        "title": "$:/plugins/ajh/tiddlytime",
        "description": "Tiddlytime Button",
        "author": "Andrew",
        "version": "0.0.8",
        "core-version": ">=5.1.11",
        "source": "https://github.com/infurnoape/tw5-plugins",
        "plugin-type": "plugin",
	"list": "readme",
        "dependents": "",
        "type": "application/json"
    },
    {
        "title": "$:/plugins/ajh/tiddlyviewer",
        "description": "Tiddly Viewer",
        "author": "Andrew",
        "version": "0.0.14",
        "core-version": ">=5.1.11",
        "source": "https://github.com/infurnoape/tw5-plugins",
        "plugin-type": "plugin",
	"list": "readme",
        "dependents": "",
        "type": "application/json"
    },
    {
        "title": "$:/plugins/ajh/toplefttoolbar",
        "description": "Top Left Toolbar",
        "author": "Andrew",
        "version": "0.0.10",
        "core-version": ">=5.1.14",
        "source": "https://github.com/infurnoape/tw5-plugins",
        "plugin-type": "plugin",
	"list": "readme",
        "dependents": "",
        "type": "application/json"
    }
];

/*\
title: $:/plugins/tiddlywiki/pluginlibrary/libraryserver.js
type: application/javascript
module-type: library

A simple HTTP-over-window.postMessage implementation of a standard TiddlyWeb-compatible server. It uses real HTTP to load the individual tiddler JSON files.

\*/
(function(){

/*jslint node: true, browser: true */
/*global $tw: false */
"use strict";

// Listen for window messages
window.addEventListener("message",function listener(event){
	console.log("plugin library: Received message from",event.origin);
	console.log("plugin library: Message content",event.data);
	switch(event.data.verb) {
		case "GET":
			if(event.data.url === "recipes/library/tiddlers.json") {
				// Route for recipes/library/tiddlers.json
				event.source.postMessage({
					verb: "GET-RESPONSE",
					status: "200",
					cookies: event.data.cookies,
					url: event.data.url,
					type: "application/json",
					body: JSON.stringify(assetList,null,4)
				},"*");
			} else if(event.data.url.indexOf("recipes/library/tiddlers/") === 0) {
				var url = "recipes/library/tiddlers/" + encodeURIComponent(removePrefix(event.data.url,"recipes/library/tiddlers/"));
				// Route for recipes/library/tiddlers/<uri-encoded-tiddler-title>.json
				httpGet(url,function(err,responseText) {
					if(err) {
						event.source.postMessage({
							verb: "GET-RESPONSE",
							status: "404",
							cookies: event.data.cookies,
							url: event.data.url,
							type: "text/plain",
							body: "Not found"
						},"*");
					} else {
						event.source.postMessage({
							verb: "GET-RESPONSE",
							status: "200",
							cookies: event.data.cookies,
							url: event.data.url,
							type: "application/json",
							body: responseText
						},"*");
					}
				});
			} else {
				event.source.postMessage({
					verb: "GET-RESPONSE",
					status: "404",
					cookies: event.data.cookies,
					url: event.data.url,
					type: "text/plain",
					body: "Not found"
				},"*");
			}
			break;
	}
},false);

// Helper to remove string prefixes
function removePrefix(string,prefix) {
	if(string.indexOf(prefix) === 0) {
		return string.substr(prefix.length);
	} else {
		return string;
	}
}

// Helper for HTTP GET
function httpGet(url,callback) {
	var http = new XMLHttpRequest();
	http.open("GET",url,true);
	http.onreadystatechange = function() {
		if(http.readyState == 4 && http.status == 200) {
			callback(null,http.responseText);
		}
	};
	http.send();
}

})();

</script>
</head>
<body><h1>Hello Visitor</h1><p>This is the library for <a href="https://github.com/Infurnoape/tw5-plugins" target="_blank">plugins/ajh</a>. It is not intended to be opened directly in the browser.</p><p>See <a href="http://t5a.tiddlyspot.com/#Library" target="_blank">t5a.tiddlyspot.com/Library</a> for details of how to install plugins.</p></body>
</html>
